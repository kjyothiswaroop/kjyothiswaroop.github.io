{{- define "main" -}}

<article class="article article-project">
  <div class="article-container project-single">

    <header class="project-hero">
      <h1 class="project-title">{{ .Params.project_title | default .Title }}</h1>

      {{/* Author | Date */}}
      {{ $author := .Params.author }}
      {{ with .Params.authors }}
        {{ if and (not $author) (gt (len .) 0) }}
          {{ $author = index . 0 }}
        {{ end }}
      {{ end }}
      <p class="project-meta">{{ if $author }}{{ $author }} | {{ end }}{{ .Date.Format "Jan 2, 2006" }}</p>

      {{ with .Params.links }}
      <div class="project-links">
        {{ range . }}
          <a class="project-link-btn" href="{{ .url | safeURL }}" target="_blank" rel="noopener">
            <span class="project-link-icon">
              <i class="{{ .icon_pack | default "fab" }} fa-{{ .icon | default "link" }}" aria-hidden="true"></i>
            </span>
            <span>{{ .name }}</span>
          </a>
        {{ end }}
      </div>
      {{ end }}
    </header>

    {{ $video := or .Params.video .Params.video_url }}
    {{ if $video }}
      {{ $is_embed := or (strings.Contains $video "youtube.com") (strings.Contains $video "youtu.be") (strings.Contains $video "vimeo.com") }}
      <div class="project-embed">
        {{ if $is_embed }}
          <div class="embed-responsive embed-responsive-16by9">
            <iframe class="embed-responsive-item" src="{{ $video | safeURL }}" allowfullscreen loading="lazy"></iframe>
          </div>
        {{ else }}
          <video controls playsinline preload="metadata">
            <source src="{{ $video | safeURL }}" type="video/mp4">
          </video>
        {{ end }}
      </div>
    {{ else }}
      {{ $images := where .Resources "ResourceType" "image" }}
      {{ with index $images 0 }}
        {{ $img := .Resize "480x" }}
        <div class="project-image">
          <img src="{{ $img.RelPermalink }}" alt="{{ $.Title }}">
        </div>
      {{ end }}
    {{ end }}

    {{ if and .Params.toc (ne .TableOfContents "") }}
      <div class="project-toc">{{ .TableOfContents }}</div>
    {{ end }}

    <div class="article-style project-body">
      {{ .Content }}
    </div>

    {{ partial "page_footer" . }}
  </div>
</article>
{{- end -}}
